name: Build and Deploy Code

on: [push,pull_request]
    # push:
    #     branches:
    #         - "main"
    # pull_request:
    #     branches:
    #         - "test"
environment:
    name: testing
env:
    DATABASE_HOSTNAME=${{secrets.DATABASE_HOSTNAME}}
    DATABASE_PORT=${{secrets.DATABASE_PORT}}
    DATABASE_PASSWORD=${{secrets.DATABASE_PASSWORD}}
    DATABASE_NAME=${{secrets.DATABASE_NAME}}
    DATABASE_USERNAME=${{secrets.DATABASE_USERNAME}}
    SECRET_KEY=${{secrets.SECRET_KEY}}
    ALGORITHM=${{secrets.ALGORITHM}}
    ACCESS_TOKEN_EXPIRE_MINUTES=${{secrets.ACCESS_TOKEN_EXPIRE_MINUTES}}

jobs:
    Installation:
        runs-on: windows-latest
        steps: 
            - name: Install python version 3.12
              uses: actions/checkout@v2
              with:
                python-version: "3.12"
            - name: Update pip
              run: python -m pip install --upgrade pip
            - name: Install all Dependencies
              run: pip install -r requirements.txt
    Test:
        - name: Test with pytest
          run: |
         pip install pytest
         pytest                